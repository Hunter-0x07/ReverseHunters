import{e as t}from"./app.172bf8d3.js";import{_ as d}from"./plugin-vue_export-helper.21dcd24c.js";const e={},a=t(`<h1 id="_7-44-\u514D\u6740\u8BFE\u7A0Bx86-\u4E8C" tabindex="-1"><a class="header-anchor" href="#_7-44-\u514D\u6740\u8BFE\u7A0Bx86-\u4E8C" aria-hidden="true">#</a> 7.44 \u514D\u6740\u8BFE\u7A0BX86\uFF08\u4E8C\uFF09</h1><h2 id="\u4E2D\u95F4\u7B14\u8BB0" tabindex="-1"><a class="header-anchor" href="#\u4E2D\u95F4\u7B14\u8BB0" aria-hidden="true">#</a> \u4E2D\u95F4\u7B14\u8BB0</h2><p>jmp \u6307\u4EE4\uFF1A\u8DF3\u8F6C\u5230\u6307\u5B9A\u5730\u5740\uFF1B\u672C\u8D28 =&gt; \u4FEE\u6539 EIP\uFF08\u8BF4\u6CD5\u6709\u5F85\u8003\u7A76\uFF0C\u6682\u4E14\u542C\u8BB2\u8BFE\u5E08\u5085\u7684\uFF09\uFF1B</p><p>\u5806\u6808\u5E73\u8861\uFF1A\u5982\u4F7F\u7528 call \u6307\u4EE4\uFF0C\u5176\u4F1A\u8C03\u6574\u5806\u6808\u6307\u9488\uFF0C\u5F53\u8FD4\u56DE\u7684\u65F6\u5019\uFF0C\u5806\u6808\u6062\u590D\u5230\u539F\u59CB\u72B6\u6001\u5C31\u79F0\u4E3A\u5806\u6808\u5E73\u8861\uFF1B call \u6307\u4EE4\uFF1A\u5148\u5C06 call \u6307\u4EE4\u540E\u4E00\u6761\u6307\u4EE4\u5730\u5740\u5165\u6808\uFF0C\u5165\u6808\u80AF\u5B9A\u4F1A\u8C03\u6574 ESP \u561B\uFF0C\u56E0\u4E3A ESP \u6307\u5411\u7684\u662F\u6808\u9876\uFF1B ret \u6307\u4EE4\uFF1A\u5C06\u4E4B\u524D\u4FDD\u5B58\u7684 call \u6307\u4EE4\u540E\u4E0B\u4E00\u6761\u6307\u4EE4\u51FA\u6808\u5230 EIP\uFF0C\u51FA\u6808\u540E ESP \u6307\u9488\u968F\u5373\u8C03\u6574\u561B\uFF1B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \uFF08\u8FD9\u91CC\u6709\u4E2A\u7591\u95EE\u54C8\uFF0C\u6211\u8981\u662F\u5728 ret \u6307\u4EE4\u5F39\u51FA\u5730\u5740\u524D\uFF0C\u518D\u538B\u5165\u4E00\u4E2A\u6570\u636E\uFF0C\u6B64\u65F6\u4F1A\u4E0D\u4F1A\u5F39\u51FA\u6211\u4EEC\u7684\u538B\u5165\u7684\u6570\u636E\uFF1F\uFF09</span>
\u4E8B\u5B9E\u8BC1\u660E\u662F\u4F1A\u51FA\u9519\u7684\uFF0C\u5982\u679C\u6211\u4EEC\u6CA1\u6709\u63A7\u5236\u597D\u6808\u7684\u8BDD\uFF0Cret \u6307\u4EE4\u53EA\u4F1A\u5F39\u51FA\u5F53\u524D ESP \u6240\u6307\u5411\u7684\u4F4D\u7F6E\u7684\u6570\u636E\uFF1B
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>test \u6307\u4EE4\uFF1A\u5BF9\u4E24\u4E2A\u64CD\u4F5C\u6570\u8FDB\u884C\u76F8\u4E0E\u7684\u64CD\u4F5C\uFF0C\u7528\u6765\u5224\u65AD\u5BC4\u5B58\u5668\u7684\u503C\u662F\u5426\u4E3A 0\uFF1B \u4F8B\u5982 test eax, eax\uFF1B\u5F53 eax \u4E3A 0 \u65F6\uFF0C\u6267\u884C test \u6307\u4EE4\u540E\uFF0Czf \u6807\u5FD7\u4F4D\u7F6E\u4E3A 1\uFF0C\u4E5F\u76F8\u5F53\u4E8E\u53EA\u5F71\u54CD\u6807\u5FD7\u5BC4\u5B58\u5668\uFF1B</p><p>JCC\uFF08\u5168\u79F0\uFF1Ajump condition code\uFF09\uFF1A\u5F15\u7528 google \u89E3\u91CA\uFF1AJcc is not a single instruction, it just describes the jump mnemonics that check the condition code before jumping\uFF1B \u7B80\u5355\u7406\u89E3\u5C31\u662F\uFF0CJCC \u6307\u4EE4\u96C6\u5408\u6307\u7684\u662F\u90A3\u4E9B\u5728\u8DF3\u8F6C\u524D\u4F1A\u68C0\u67E5\u6807\u5FD7\u4F4D\u7684jump\u6307\u4EE4\uFF0C\u5982 jnz\uFF08zf = 0\u5219\u8DF3\u8F6C\uFF09\uFF0Cjz\uFF08zf = 1\u5219\u8DF3\u8F6C\uFF09\u7B49jump\u6307\u4EE4\uFF1B</p><p>\u4EE5\u4E0B\u53C2\u8003\u514D\u6740\u8001\u5E08\u7684\u8BFE\u5802\u7B14\u8BB0</p><table><thead><tr><th>JCC\u6307\u4EE4</th><th>\u4E2D\u6587\u542B\u4E49</th><th>\u82F1\u6587\u539F\u610F</th><th>\u68C0\u67E5\u7B26\u53F7\u4F4D</th><th>\u5178\u578Bc\u5E94\u7528</th></tr></thead><tbody><tr><td>JZ/JE</td><td>\u82E5\u4E3A0\u5219\u8DF3\u8F6C\uFF1B\u82E5\u76F8\u7B49\u5219\u8DF3\u8F6C</td><td>jump if zero;jump if equal</td><td>ZF=1</td><td>if (i == j);if (i == 0);</td></tr><tr><td>JNZ/JNE</td><td>\u82E5\u4E0D\u4E3A0\u5219\u8DF3\u8F6C\uFF1B\u82E5\u4E0D\u76F8\u7B49\u5219\u8DF3\u8F6C</td><td>jump if not zero;jump if not equal</td><td>ZF=0</td><td>if (i != j);if (i != 0);</td></tr><tr><td>JS</td><td>\u82E5\u4E3A\u8D1F\u5219\u8DF3\u8F6C</td><td>jump if sign</td><td>SF=1</td><td>if (i &lt; 0);</td></tr><tr><td>JNS</td><td>\u82E5\u4E3A\u6B63\u5219\u8DF3\u8F6C</td><td>jump if not sign</td><td>SF=0</td><td>if (i &gt; 0);</td></tr><tr><td>JP/JPE</td><td>\u82E51\u51FA\u73B0\u6B21\u6570\u4E3A\u5076\u6570\u5219\u8DF3\u8F6C</td><td>jump if Parity (Even)</td><td>PF=1</td><td>(null)</td></tr><tr><td>JNP/JPO</td><td>\u82E51\u51FA\u73B0\u6B21\u6570\u4E3A\u5947\u6570\u5219\u8DF3\u8F6C</td><td>jump if not parity (odd)</td><td>PF=0</td><td>(null)</td></tr><tr><td>JO</td><td>\u82E5\u6EA2\u51FA\u5219\u8DF3\u8F6C</td><td>jump if overflow</td><td>OF=1</td><td>(null)</td></tr><tr><td>JNO</td><td>\u82E5\u65E0\u6EA2\u51FA\u5219\u8DF3\u8F6C</td><td>jump if not overflow</td><td>OF=0</td><td>(null)</td></tr><tr><td>JC/JB/JNAE</td><td>\u82E5\u8FDB\u4F4D\u5219\u8DF3\u8F6C\uFF1B\u82E5\u4F4E\u4E8E\u5219\u8DF3\u8F6C\uFF1B\u82E5\u4E0D\u9AD8\u4E8E\u7B49\u4E8E\u5219\u8DF3\u8F6C</td><td>jump if carry;jump if below;jump if not above equal</td><td>CF=1</td><td>if (i &lt; j);</td></tr><tr><td>JNC/JNB/JAE</td><td>\u82E5\u65E0\u8FDB\u4F4D\u5219\u8DF3\u8F6C\uFF1B\u82E5\u4E0D\u4F4E\u4E8E\u5219\u8DF3\u8F6C\uFF1B\u82E5\u9AD8\u4E8E\u7B49\u4E8E\u5219\u8DF3\u8F6C</td><td>jump if not carry;jump if not below;jump if above equal</td><td>CF=0</td><td>if (i &gt;= j);</td></tr><tr><td>JBE/JNA</td><td>\u82E5\u4F4E\u4E8E\u7B49\u4E8E\u5219\u8DF3\u8F6C\uFF1B\u82E5\u4E0D\u9AD8\u4E8E\u5219\u8DF3\u8F6C</td><td>jump if below equal;jump if not above</td><td>ZF=1\u6216CF=1</td><td>if (i &lt;= j);</td></tr><tr><td>JNBE/JA</td><td>\u82E5\u4E0D\u4F4E\u4E8E\u7B49\u4E8E\u5219\u8DF3\u8F6C\uFF1B\u82E5\u9AD8\u4E8E\u5219\u8DF3\u8F6C</td><td>jump if not below equal;jump if above</td><td>ZF=0\u6216CF=0</td><td>if (i &gt; j);</td></tr><tr><td>JL/JNGE</td><td>\u82E5\u5C0F\u4E8E\u5219\u8DF3\u8F6C\uFF1B\u82E5\u4E0D\u5927\u4E8E\u7B49\u4E8E\u5219\u8DF3\u8F6C</td><td>jump if less;jump if not greater equal</td><td>SF != OF</td><td>if (si &lt; sj);</td></tr><tr><td>JNL/JGE</td><td>\u82E5\u4E0D\u5C0F\u4E8E\u5219\u8DF3\u8F6C\uFF1B\u82E5\u5927\u4E8E\u7B49\u4E8E\u5219\u8DF3\u8F6C</td><td>jump if not less;jump if greater equal</td><td>SF=OF</td><td>if (si &gt;= sj);</td></tr><tr><td>JLE/JNG</td><td>\u82E5\u5C0F\u4E8E\u7B49\u4E8E\u5219\u8DF3\u8F6C\uFF1B\u82E5\u4E0D\u5927\u4E8E\u5219\u8DF3\u8F6C</td><td>jump if less equal;jump if not greater</td><td>ZF != OF \u6216 ZF=1</td><td>if (si &lt;= sj);</td></tr><tr><td>JNLE/JG</td><td>\u82E5\u4E0D\u5C0F\u4E8E\u7B49\u4E8E\u5219\u8DF3\u8F6C\uFF1B\u82E5\u5927\u4E8E\u5219\u8DF3\u8F6C</td><td>jump if not less equal;jump if greater</td><td>SF=OF \u4E14 ZF=0</td><td>if(si&gt;sj)</td></tr></tbody></table><p>olldbg \u4E2D\u4E0B\u65AD\u70B9\u662F F2\uFF1B</p><p>\u514D\u6740\u8BFE\u7A0B\u4E2D\u8001\u5E08\u6240\u8BF4\u7684\u201C\u63D0\u5347\u6808\u9876\u201D\u7B49\u4EF7\u4E8E\u6808\u9876\u6307\u9488\u51CF 4\uFF1B \u201C\u964D\u4F4E\u6808\u9876\u201D\u7B49\u4EF7\u4E8E\u6808\u9876\u6307\u9488\u52A0 4\uFF1B</p><p>lea\uFF08load effective address\uFF09 \u6307\u4EE4\uFF0C\u53D6\u5185\u5B58\u504F\u79FB\u5730\u5740\uFF0C\u5982 lea edi, dword ptr ss:[ebp-0x48]</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rep\uFF08repeat\uFF09\u6307\u4EE4\uFF1A\u91CD\u590D\u6267\u884C\u8BE5\u6307\u4EE4\u540E\u9762\u7684\u6C47\u7F16\u4EE3\u7801\uFF0C\u6267\u884C\u6B21\u6570\u7531 ecx \u63A7\u5236\u3002

\u5B8C\u6574\u5F62\u5F0F\u5982\u4E0B
mov ecx, 0x10  <span class="token punctuation">;</span><span class="token punctuation">;</span> \u9996\u5148\u7ED9 ecx \u8D4B\u503C\u786E\u5B9A\u5FAA\u73AF\u6B21\u6570\uFF1B
rep stos dword ptr es:<span class="token punctuation">[</span>edi<span class="token punctuation">]</span>    <span class="token punctuation">;</span><span class="token punctuation">;</span> \u7136\u540E\u5FAA\u73AF 0x10\uFF08\u537316\uFF09\u6B21\u5C06 eax \u503C\u8D4B\u503C\u7ED9 es:<span class="token punctuation">[</span>edi<span class="token punctuation">]</span>\uFF0C\u5E76\u4E14\u5FAA\u73AF\u4E00\u6B21\uFF0Cedi \u81EA\u589E\u6216\u81EA\u51CF\u4E00\u6B21\uFF0C\u5176\u7531 DF \u6807\u5FD7\u4F4D\u51B3\u5B9A\uFF08STOS \u6307\u4EE4\u8BE6\u60C5\u53C2\u8003 <span class="token number">7.43</span> \u514D\u6740\u8BFE\u7A0BX86\uFF08\u4E00\uFF09\uFF09\uFF1B
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ESP\uFF08\u6808\u9876\u6307\u9488\uFF09\uFF08extended stack pointer: \u82F1\u6587\u76F4\u8BD1\u4E3A \u6269\u5C55\u6808\u6307\u9488\uFF09 EBP\uFF08\u6808\u5E95\u6307\u9488\uFF09\uFF08extended base pointer\uFF1A\u82F1\u6587\u76F4\u8BD1\u4E3A \u6269\u5C55\u57FA\u5740\u6307\u9488\uFF09 \u5916\u5E73\u6808\uFF1A\u5373\u5728 call \u8C03\u7528\u7ED3\u675F\u4EE5\u540E\u518D\u589E\u52A0\u6808\u9876\u6307\u9488\uFF1B \u5185\u5E73\u6808\uFF1A\u5373\u5728 call \u8C03\u7528\u5185\u901A\u8FC7 retn \u6307\u4EE4\u6765\u589E\u52A0\u6808\u9876\u6307\u9488\uFF1B</p><h2 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h2><p>11:46 \u665A\u4E0A\u5982\u679C\u6709\u7A7A\u7684\u8BDD\u505A\u4E00\u4E0B\u8FD9\u4E2A\u5B9E\u9A8C\uFF0C\u987A\u4FBF\u770B\u4E00\u4E0B rep \u6307\u4EE4\uFF0C\u6CA1\u7A7A\u5C31\u660E\u5929\uFF0C\u56E0\u4E3A\u665A\u4E0A\u8981\u5065\u8EAB\uFF1B</p><p>2022.6.16 9:39 \u5206\u5F00\u59CB\u7EE7\u7EED\u5B66\u4E60\uFF1B</p>`,17);function n(s,i){return a}var l=d(e,[["render",n]]);export{l as default};
